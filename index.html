<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Рииҙмал (Rīðmal) Latin-to-Cyrillic Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: "Inter", "Noto Sans", sans-serif;
            background-color: #0d1117; /* Dark background */
        }
        textarea {
            resize: none;
            line-height: 1.6;
        }
        #cyrillicOutput {
            font-size: 1.5rem;
            line-height: 2;
            min-height: 200px;
            background-color: #161b22;
            border-color: #21262d;
            color: #c9d1d9;
        }
        .key-pair {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px dashed rgba(201, 209, 217, 0.1);
            padding: 4px 0;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#58a6ff',
                        'secondary-gray': '#8b949e',
                    }
                }
            }
        }
        
        // RĪÐMAL_MAP: Kept in original order (longest match first) to ensure correct conversion logic.
        const RĪÐMAL_MAP = new Map([
            // Trigraphs/Unicode (Highest priority)
            ["uue", "ӱӱ"], // Ǖ ǖ
            ["ǖ", "ӱӱ"], 

            // Digraphs/Long Vowels/Special Consonants
            // Vowels
            ["aa", "аа"], ["ee", "ее"], ["ii", "ии"], ["oo", "оо"], ["uu", "уу"],
            ["ā", "аа"], ["ē", "ее"], ["ī", "ии"], ["ō", "оо"], ["ü", "уу"], // Note: 'ü' maps to long U 'уу' in this map.

            // Fricatives/Stops/Affricates
            ["dh", "ҙ"],   // Ð ð
            ["ð", "ҙ"],

            ["th", "ҫ"],   // Þ þ
            ["þ", "ҫ"],

            ["gh", "ғ"],   // Ǥ ǥ
            ["ǥ", "ғ"],

            ["ħ", "һ"],   // Ħ ħ
            ["h", "һ"],

            ["hv", "ꚕ"],   // Ƕ ƕ
            ["ƕ", "ꚕ"],

            ["ch", "ч"],   // Č č
            ["č", "ч"],

            ["dz", "ӡ"],   // Dz dz
            
            ["sh", "ш"],   // Š š
            ["š", "ш"],

            ["zh", "ж"],   // Ž ž
            ["ž", "ж"],

            ["jzh", "џ"],  // Ʒ ʒ
            
            // Nasals/Laterals/Schwa
            ["ng", "ҥ"],   // Ꞑ
            ["ꞑ", "ҥ"],
            
            ["ꝇ", "л"], //ɮ
            ["lh", "л"],

            ["ny", "нь"],   // Ꞥ
            ["ꞥ", "нь"],

            ["ax", "ъ"],   // Ә
            ["ə", "ъ"],

            ["eh", "э"],
            ["ä", "э"],

            ["å", "ѡ"],
            ["aw", "ѡ"],


            // ---Vowels (Short)
            ["a", "а"], ["e", "е"], ["i", "и"], ["o", "о"], ["u", "у"], ["y", "ы"],
            ["ue", "ӱ"], // Ü ü (Short/simple Ü)
            ["ü", "ӱ"],
            ["oe", "ө"], // Ö ö
            ["ö", "ө"], 
            
            // ---Consonants (Simple)
            ["b", "б"], ["c", "ц"], ["d", "д"], ["f", "ф"], ["g", "г"], ["j", "й"],
            ["k", "к"], ["l", "ль"], ["m", "м"], ["n", "н"], ["p", "п"], ["r", "р"],
            ["s", "с"], ["t", "т"], ["v", "ѵ"], ["w", "в"], ["x", "х"], ["z", "з"], 
            ["tz", "ц"], ["ts", "ц"], ["ß", "сс"], ["qu", "кꚕ"],
        ]);

        function convertText() {
            const input = document.getElementById('latinInput').value; 
            let cyrillicOutput = '';
            let i = 0;
            let isInsideQuote = false; // State tracker for quotation marks

            while (i < input.length) {
                let foundMatch = false;

                // 1. Handle special quote character '|' (Pipe)
                if (input[i] === '|') {
                    if (isInsideQuote) {
                        cyrillicOutput += '»'; // Closing quote (even number)
                        isInsideQuote = false;
                    } else {
                        cyrillicOutput += '«'; // Opening quote (odd number)
                        isInsideQuote = true;
                    }
                    i++;
                    foundMatch = true;
                }
                
                if (!foundMatch) {
                    // 2. Check for standard character conversions (longest match first)
                    for (let len = 3; len >= 1; len--) {
                        const segment = input.substring(i, i + len);
                        const lowerSegment = segment.toLowerCase();
                        
                        if (RĪÐMAL_MAP.has(lowerSegment)) {
                            let cyrillic = RĪÐMAL_MAP.get(lowerSegment);
                            
                            // Casing Logic: Check if the first character of the Latin input was uppercase
                            const firstChar = segment.charAt(0);
                            const isFirstCharCased = (firstChar !== firstChar.toLowerCase()); 

                            if (isFirstCharCased) {
                                // Apply capitalization to the first letter of the Cyrillic output
                                cyrillic = cyrillic.charAt(0).toUpperCase() + cyrillic.slice(1);
                            }

                            cyrillicOutput += cyrillic;
                            i += len;
                            foundMatch = true;
                            break;
                        }
                    }
                }

                if (!foundMatch) {
                    // 3. Fallback: Copy character directly (punctuation, spaces, numbers, etc.)
                    cyrillicOutput += input[i];
                    i++;
                }
            }

            document.getElementById('cyrillicOutput').value = cyrillicOutput;
        }

        // Key lists structured for display (Vowels then Consonants)
        const VOWEL_KEYS = [
            // Short Vowels
            { latin: 'A a', cyrillic: 'А а', input: 'a' },
            { latin: 'E e', cyrillic: 'Е е', input: 'e' },
            { latin: 'I i', cyrillic: 'И и', input: 'i' },
            { latin: 'O o', cyrillic: 'О о', input: 'o' },
            { latin: 'U u', cyrillic: 'У у', input: 'u' },
            { latin: 'Y y', cyrillic: 'Ы ы', input: 'y' },

            // Long Vowels (Input: Digraph / Macron)
            { latin: 'Ā ā (aa)', cyrillic: 'АА аа', input: 'aa' },
            { latin: 'Ē ē (ee)', cyrillic: 'ЕЕ ее', input: 'ee' },
            { latin: 'Ī ī (ii)', cyrillic: 'ИИ ии', input: 'ii' },
            { latin: 'Ō ō (oo)', cyrillic: 'Оо оо', input: 'oo' },
            { latin: 'Ū ū (uu)', cyrillic: 'Уу уу', input: 'uu' },

            // Special Vowels (Input: Diacritics / ASCII substitute)
            { latin: 'Ä ä / eh', cyrillic: 'Э э', input: 'eh' },
            { latin: 'Ö ö / oe', cyrillic: 'Ө ө', input: 'oe' },
            { latin: 'Ü ü / ue', cyrillic: 'Ӳ ӱ', input: 'ue' },
            { latin: 'Ǖ ǖ / uue', cyrillic: 'ӲӲ ӳӳ', input: 'uue' },
            { latin: 'Å å / aw', cyrillic: 'Ѡ ѡ', input: 'aw' },
            { latin: 'Ə ə / ax', cyrillic: 'Ъ ъ', input: 'ax' },
        ];

        const CONSONANT_KEYS = [
            // Simple Consonants
            { latin: 'B b', cyrillic: 'Б б', input: 'b' },
            { latin: 'C c / ts / tz', cyrillic: 'Ц ц', input: 'c' },
            { latin: 'D d', cyrillic: 'Д д', input: 'd' },
            { latin: 'F f', cyrillic: 'Ф ф', input: 'f' },
            { latin: 'G g', cyrillic: 'Г г', input: 'g' },
            { latin: 'J j', cyrillic: 'Й й', input: 'j' },
            { latin: 'K k', cyrillic: 'К к', input: 'k' },
            { latin: 'L l', cyrillic: 'Ль ль', input: 'l' },
            { latin: 'M m', cyrillic: 'М м', input: 'm' },
            { latin: 'N n', cyrillic: 'Н н', input: 'n' },
            { latin: 'P p', cyrillic: 'П п', input: 'p' },
            { latin: 'R r', cyrillic: 'Р р', input: 'r' },
            { latin: 'S s', cyrillic: 'С с', input: 's' },
            { latin: 'T t', cyrillic: 'Т т', input: 't' },
            { latin: 'V v', cyrillic: 'Ѵ ѵ', input: 'v' },
            { latin: 'W w', cyrillic: 'В в', input: 'w' },
            { latin: 'X x', cyrillic: 'Х х', input: 'x' },
            { latin: 'Z z', cyrillic: 'З з', input: 'z' },

            // Compound / Special Consonants (Digraphs / Diacritics)
            { latin: 'Ch ch / Č č', cyrillic: 'Ч ч', input: 'ch' },
            { latin: 'Ð ð / Dh dh', cyrillic: 'Ҙ ҙ', input: 'dh' }, // Updated label
            { latin: 'Dz dz', cyrillic: 'Ӡ ӡ', input: 'dz' },
            { latin: 'Ǥ ǥ / gh', cyrillic: 'Ғ ғ', input: 'gh' },
            { latin: 'Ħ ħ / h', cyrillic: 'Һ һ', input: 'h' },
            { latin: 'Ƕ ƕ / hv', cyrillic: 'ꚕ ꚕ', input: 'hv' },
            { latin: 'Ʒ ʒ / jzh', cyrillic: 'Џ џ', input: 'jzh' },
            { latin: 'Ꝇ ꝇ / lh', cyrillic: 'Л л', input: 'lh' },
            { latin: 'Ꞑ ꞑ / ng', cyrillic: 'Ҥ ҥ', input: 'ng' },
            { latin: 'Ꞥ ꞥ / ny', cyrillic: 'Нь нь', input: 'ny' },
            { latin: 'Š š / sh', cyrillic: 'Ш ш', input: 'sh' },
            { latin: 'Þ þ / th', cyrillic: 'Ҫ ҫ', input: 'th' },
            { latin: 'Ž ž / zh', cyrillic: 'Ж ж', input: 'zh' },
            { latin: 'ß (ss)', cyrillic: 'СС сс', input: 'ß' },
            { latin: 'Qu/Khv', cyrillic: 'Кꚕ кꚕ', input: 'кꚕ' },
        ];


        // Populate the key list when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            const keyList = document.getElementById('conversionKeyList');
            
            const renderKey = (label, input, output, isSpecial = false) => {
                const div = document.createElement('div');
                div.className = 'key-pair';
                // Mark special inputs (digraphs/diacritics/compounds) with green text
                const inputClass = isSpecial ? 'text-green-400' : 'text-primary-blue';
                
                // For combined entries, use the primary input (e.g., 'c') but show the others in the label
                let inputDisplay = input;
                if (input === 'c') inputDisplay = 'c / ts / tz';
                
                div.innerHTML = `
                    <span class="text-secondary-gray">${label}</span>
                    <div class="flex items-center space-x-4">
                        <span class="font-mono ${inputClass} text-sm bg-gray-700 px-2 py-1 rounded">${inputDisplay}</span>
                        <span class="font-bold text-lg text-yellow-300">${output}</span>
                    </div>
                `;
                keyList.appendChild(div);
            };

            // 1. Guillemet Rule
            const quoteRule = document.createElement('div');
            quoteRule.className = 'key-pair bg-green-900/50 rounded-lg p-2 mt-4 mb-4 font-semibold border-green-700 border';
            quoteRule.innerHTML = `
                <span class="text-green-400">Guillemet Rule</span>
                <div class="flex items-center space-x-4">
                    <span class="font-mono text-white text-sm bg-green-700 px-2 py-1 rounded">| (Pipe)</span>
                    <span class="font-bold text-xl text-yellow-300">« »</span>
                </div>
            `;
            keyList.appendChild(quoteRule);

            // 2. VOWELS Header
            const vowelHeader = document.createElement('div');
            vowelHeader.className = 'text-center text-primary-blue mt-6 mb-2 font-semibold text-lg';
            vowelHeader.textContent = 'Vowels (Short, Long, & Special)';
            keyList.appendChild(vowelHeader);

            // 3. VOWELS List
            VOWEL_KEYS.forEach(item => {
                const isSpecial = ['aa', 'ee', 'ii', 'oo', 'uu', 'eh', 'oe', 'ue', 'uue', 'aw', 'ax'].includes(item.input);
                renderKey(item.latin, item.input, item.cyrillic, isSpecial);
            });

            // 4. CONSONANTS Header
            const consonantHeader = document.createElement('div');
            consonantHeader.className = 'text-center text-primary-blue mt-6 mb-2 font-semibold text-lg';
            consonantHeader.textContent = 'Consonants (Simple & Special)';
            keyList.appendChild(consonantHeader);

            // 5. CONSONANTS List
            CONSONANT_KEYS.forEach(item => {
                // Determine if it's a simple single-letter consonant or a compound/diacritic for coloring
                const isSpecial = !['b', 'd', 'f', 'g', 'j', 'k', 'l', 'm', 'n', 'p', 'r', 's', 't', 'v', 'w', 'x', 'z'].includes(item.input);
                renderKey(item.latin, item.input, item.cyrillic, isSpecial);
            });

        });
    </script>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-white mb-6 border-b border-primary-blue pb-2">
            Rīðmal Latin-to-Cyrillic Transcriber (Version 2.0)
        </h1>
        <p class="text-secondary-gray mb-6">
            This transcriber uses the <span class="text-primary-blue font-semibold">ASCII inputs provided in the key</span> for all letters with diacritics (e.g., 'ch' for Č) to make typing easier. (J makes the English Y sound)
        </p>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2">
                <label for="latinInput" class="block text-xl font-semibold text-primary-blue mb-3">
                    Latin Input
                </label>
                <textarea id="latinInput" oninput="convertText()" rows="6" 
                    placeholder="Type your Rīðmal words here (e.g., Aall, Chazh, Nyoo, Uueoo)"
                    class="w-full p-4 rounded-lg bg-gray-800 text-white border border-gray-700 focus:ring-primary-blue focus:border-primary-blue transition duration-200"></textarea>

                <label for="cyrillicOutput" class="block text-xl font-semibold text-primary-blue mt-6 mb-3">
                    Cyrillic Output
                </label>
                <textarea id="cyrillicOutput" rows="6" readonly
                    class="w-full p-4 rounded-lg text-2xl bg-gray-900 text-yellow-300 border border-gray-700 cursor-not-allowed" style="font-family: 'Times New Roman', serif;"></textarea>
                
                <p class="mt-4 text-secondary-gray text-sm">
                    *Note: Due to font restrictions, some rare Cyrillic characters (example: ꚕ or Ѵ) may appear slightly inconsistent, but the encoding is correct.
                </p>
            </div>

            <div class="lg:col-span-1 bg-gray-800 p-6 rounded-lg shadow-xl border border-gray-700">
                <h2 class="text-xl font-bold text-white mb-4 border-b border-gray-600 pb-2">
                    Conversion Key (Latin Character to ASCII Input to Cyrillic)
                </h2>
                <div id="conversionKeyList" class="text-sm">
                </div>
            </div>
        </div>

    </div>

</body>
</html>
