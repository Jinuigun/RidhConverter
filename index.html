<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ríðmal Latin-to-Cyrillic Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font stack to ensure all complex Cyrillic characters render */
        body {
            font-family: "Inter", "Noto Sans", sans-serif;
            background-color: #0d1117; /* Dark background */
        }
        textarea {
            resize: none;
            line-height: 1.6;
        }
        /* Custom styles for the Ríðmal output */
        #cyrillicOutput {
            font-size: 1.5rem;
            line-height: 2;
            min-height: 200px;
            background-color: #161b22;
            border-color: #21262d;
            color: #c9d1d9;
        }
        /* Style for the conversion key */
        .key-pair {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px dashed rgba(201, 209, 217, 0.1);
            padding: 4px 0;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#58a6ff',
                        'secondary-gray': '#8b949e',
                    }
                }
            }
        }

        // --- RÍÐMAL CONVERSION MAPPING (Lowercase base for accurate casing) ---
        // Input uses ASCII digraphs for ease of typing the Latin characters with diacritics.
        const RÍÐMAL_MAP = new Map([
            // --- 1. Long Vowels (Trigraphs and Quadgraphs for priority) ---
            ["uue", "ӱӱ"], // Ǖ ǖ (Long Ü)
            
            // --- 2. Digraphs/Trigraphs (Consonants and Long Vowels) ---
            // Vowels
            ["aa", "аа"], ["ee", "ее"], ["ii", "ии"], ["oo", "оо"], ["uu", "уу"],
            
            // Fricatives/Stops/Affricates
            ["dh", "ҙ"],   // Ð ð
            ["th", "ҫ"],   // Þ þ
            ["gh", "ғ"],   // Ǥ ǥ
            ["hh", "һ"],   // Ħ ħ (using hh for input)
            ["hw", "ꚕ"],   // Ƕ ƕ (Hwair)
            ["ch", "ч"],   // Č č
            ["dz", "ӡ"],   // Dz dz
            ["sh", "ш"],   // Š š
            ["zh", "ж"],   // Ž ž
            ["jzh", "џ"],  // Ʒ ʒ (Voiced Affricate)
            
            // Nasals/Laterals/Schwa (Specific compounds)
            ["ng", "ҥ"],   // Ꞑ ꞑ
            ["lh", "ль"],   // Ꝇ ꝇ (Palatalized L, using 'lh' for input)
            ["ny", "нь"],   // Ꞥ ꞥ (Palatalized N, using 'ny' for input)
            ["ax", "ъ"],   // Ә ə (Schwa/Hard Sign)
            
            // New characters assigned generic digraphs
            ["eh", "э"],   // N/A -> Э 
            ["aw", "ѡ"],   // N/A -> Ѡ 

            // --- 3. Simple Vowels (Must be defined after digraphs) ---
            ["a", "а"], ["e", "е"], ["i", "и"], ["o", "о"], ["u", "у"], ["y", "ы"],
            ["ue", "ӱ"], // Ü ü (Ü ü)
            ["oe", "ө"], // Ö ö (Ö ö)
            
            // --- 4. Simple Consonants (Must be defined after digraphs) ---
            ["b", "б"], ["c", "ц"], ["d", "д"], ["f", "ф"], ["g", "г"], ["j", "й"],
            ["k", "к"], ["l", "л"], ["m", "м"], ["n", "н"], ["p", "п"], ["r", "р"],
            ["s", "с"], ["t", "т"], ["v", "ѵ"], ["w", "в"], ["x", "х"], ["z", "з"], 
        ]);

        function convertText() {
            // Keep original case input
            const input = document.getElementById('latinInput').value; 
            let cyrillicOutput = '';
            let i = 0;

            while (i < input.length) {
                let foundMatch = false;

                // Check for the longest possible match (3, 2, or 1 character)
                for (let len = 3; len >= 1; len--) {
                    const segment = input.substring(i, i + len);
                    const lowerSegment = segment.toLowerCase();
                    
                    if (RÍÐMAL_MAP.has(lowerSegment)) {
                        let cyrillic = RÍÐMAL_MAP.get(lowerSegment);
                        
                        // Casing Logic: Check if the first character of the Latin input was uppercase
                        const firstChar = segment.charAt(0);
                        const isFirstCharCased = (firstChar !== firstChar.toLowerCase()); // Check if it's a letter and is uppercase

                        if (isFirstCharCased) {
                            // Apply capitalization to the first letter of the Cyrillic output
                            cyrillic = cyrillic.charAt(0).toUpperCase() + cyrillic.slice(1);
                        }

                        cyrillicOutput += cyrillic;
                        i += len;
                        foundMatch = true;
                        break;
                    }
                }

                // If no match was found for 1-3 characters (e.g., punctuation, numbers, unknown chars), copy as is
                if (!foundMatch) {
                    cyrillicOutput += input[i];
                    i++;
                }
            }

            document.getElementById('cyrillicOutput').value = cyrillicOutput;
        }

        // Populate the key list when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            const keyList = document.getElementById('conversionKeyList');
            
            // Re-order and structure for display
            const orderedKeys = [
                { latin: 'A a', cyrillic: 'А а', input: 'a' },
                { latin: 'Ā ā', cyrillic: 'АА аа', input: 'aa' },
                { latin: 'B b', cyrillic: 'Б б', input: 'b' },
                { latin: 'C c', cyrillic: 'Ц ц', input: 'c' },
                { latin: 'Č č', cyrillic: 'Ч ч', input: 'ch' },
                { latin: 'D d', cyrillic: 'Д д', input: 'd' },
                { latin: 'Ð ð', cyrillic: 'Ҙ ҙ', input: 'dh' },
                { latin: 'Dz dz', cyrillic: 'Ӡ ӡ', input: 'dz' },
                { latin: 'E e', cyrillic: 'Е е', input: 'e' },
                { latin: 'Ē ē', cyrillic: 'ЕЕ ее', input: 'ee' },
                { latin: 'F f', cyrillic: 'Ф ф', input: 'f' },
                { latin: 'G g', cyrillic: 'Г г', input: 'g' },
                { latin: 'Ǥ ǥ', cyrillic: 'Ғ ғ', input: 'gh' },
                { latin: 'Ħ ħ', cyrillic: 'Һ һ', input: 'hh' },
                { latin: 'I i', cyrillic: 'И и', input: 'i' },
                { latin: 'Ī ī', cyrillic: 'ИИ ии', input: 'ii' },
                { latin: 'J j', cyrillic: 'Й й', input: 'j' },
                { latin: 'K k', cyrillic: 'К к', input: 'k' },
                { latin: 'L l', cyrillic: 'Л л', input: 'l' },
                { latin: 'Ꝇ ꝇ', cyrillic: 'ЛЬ ль', input: 'lh' },
                { latin: 'Ƕ ƕ', cyrillic: 'ꚕ ꚕ', input: 'hw' },
                { latin: 'M m', cyrillic: 'М м', input: 'm' },
                { latin: 'N n', cyrillic: 'Н н', input: 'n' },
                { latin: 'Ꞑ ꞑ', cyrillic: 'Ҥ ҥ', input: 'ng' },
                { latin: 'Ꞥ ꞥ', cyrillic: 'Нь нь', input: 'ny' },
                { latin: 'O o', cyrillic: 'О о', input: 'o' },
                { latin: 'Ō ō', cyrillic: 'Оо оо', input: 'oo' },
                { latin: 'Ö ö', cyrillic: 'Ө ө', input: 'oe' },
                { latin: 'P p', cyrillic: 'П п', input: 'p' },
                { latin: 'R r', cyrillic: 'Р р', input: 'r' },
                { latin: 'S s', cyrillic: 'С с', input: 's' },
                { latin: 'Š š', cyrillic: 'Ш ш', input: 'sh' },
                { latin: 'T t', cyrillic: 'Т т', input: 't' },
                { latin: 'Þ þ', cyrillic: 'Ҫ ҫ', input: 'th' },
                { latin: 'U u', cyrillic: 'У у', input: 'u' },
                { latin: 'Ū ū', cyrillic: 'Уу уу', input: 'uu' },
                { latin: 'Ü ü', cyrillic: 'Ӳ ӳ', input: 'ue' },
                { latin: 'Ǖ ǖ', cyrillic: 'ӲӲ ӳӳ', input: 'uue' },
                { latin: 'V v', cyrillic: 'Ѵ ѵ', input: 'v' },
                { latin: 'X x', cyrillic: 'Х х', input: 'x' },
                { latin: 'Y y', cyrillic: 'Ы ы', input: 'y' },
                { latin: 'Z z', cyrillic: 'З з', input: 'z' },
                { latin: 'Ž ž', cyrillic: 'Ж ж', input: 'zh' },
                { latin: 'Ʒ ʒ', cyrillic: 'Џ џ', input: 'jzh' },
                { latin: 'Ә ə', cyrillic: 'Ъ ъ', input: 'ax' },
                { latin: 'W w', cyrillic: 'В в', input: 'w' },
                { latin: 'N/A', cyrillic: 'Э э', input: 'eh' },
                { latin: 'N/A', cyrillic: 'Ѡ ѡ', input: 'aw' },
            ];

            const renderKey = (label, input, output, isSpecial = false) => {
                const div = document.createElement('div');
                div.className = 'key-pair';
                const inputClass = isSpecial ? 'text-green-400' : 'text-primary-blue';
                div.innerHTML = `
                    <span class="text-secondary-gray">${label}</span>
                    <div class="flex items-center space-x-4">
                        <span class="font-mono ${inputClass} text-sm bg-gray-700 px-2 py-1 rounded">${input}</span>
                        <span class="font-bold text-lg text-yellow-300">${output}</span>
                    </div>
                `;
                keyList.appendChild(div);
            };

            const specialHeader = document.createElement('div');
            specialHeader.className = 'text-center text-primary-blue mt-4 mb-2 font-semibold';
            specialHeader.textContent = 'Special Letters / Compounds';
            keyList.appendChild(specialHeader);

            const simpleHeader = document.createElement('div');
            simpleHeader.className = 'text-center text-primary-blue mt-6 mb-2 font-semibold';
            simpleHeader.textContent = 'Simple Letters / Long Vowels';
            keyList.appendChild(simpleHeader);

            orderedKeys.forEach(item => {
                const cyrillicOutput = item.cyrillic; // Use the formatted output for the key
                
                // Separate into groups
                const isSpecial = ['lh', 'hw', 'ng', 'ny', 'dz', 'jzh', 'dh', 'th', 'gh', 'hh', 'ch', 'sh', 'zh', 'ax', 'eh', 'aw', 'uue'].includes(item.input);
                
                if (isSpecial) {
                    renderKey(item.latin, item.input, cyrillicOutput, true);
                } else if (!isSpecial) {
                    // Render simple letters and long vowels below the header
                    renderKey(item.latin, item.input, cyrillicOutput);
                }
            });
        });
    </script>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-white mb-6 border-b border-primary-blue pb-2">
            Ríðmal Latin-to-Cyrillic Transcriber (Version 2.0)
        </h1>
        <p class="text-secondary-gray mb-6">
            This transcriber uses the <span class="text-primary-blue font-semibold">ASCII inputs provided in the key</span> for all letters with diacritics (e.g., 'ch' for Č) to make typing easier. The conversion strictly follows your new Ríðmal alphabet. **Casing is now automatically applied.**
        </p>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Input Area -->
            <div class="lg:col-span-2">
                <label for="latinInput" class="block text-xl font-semibold text-primary-blue mb-3">
                    Latin Input
                </label>
                <textarea id="latinInput" oninput="convertText()" rows="6" 
                    placeholder="Type your Ríðmal words here (e.g., Aall, Chazh, Nyoo, Uueoo)"
                    class="w-full p-4 rounded-lg bg-gray-800 text-white border border-gray-700 focus:ring-primary-blue focus:border-primary-blue transition duration-200"></textarea>

                <label for="cyrillicOutput" class="block text-xl font-semibold text-primary-blue mt-6 mb-3">
                    Cyrillic Output
                </label>
                <textarea id="cyrillicOutput" rows="6" readonly
                    class="w-full p-4 rounded-lg text-2xl bg-gray-900 text-yellow-300 border border-gray-700 cursor-not-allowed" style="font-family: 'Times New Roman', serif;"></textarea>
                
                <p class="mt-4 text-secondary-gray text-sm">
                    *Note: Due to font restrictions, some rare Cyrillic characters (like ꚕ or Ѵ) may appear slightly inconsistent, but the encoding is correct.
                </p>
            </div>

            <!-- Conversion Key -->
            <div class="lg:col-span-1 bg-gray-800 p-6 rounded-lg shadow-xl border border-gray-700">
                <h2 class="text-xl font-bold text-white mb-4 border-b border-gray-600 pb-2">
                    Conversion Key (Latin Character to ASCII Input to Cyrillic)
                </h2>
                <div id="conversionKeyList" class="text-sm">
                    <!-- Key pairs will be inserted here by JavaScript -->
                </div>
            </div>
        </div>

    </div>

</body>
</html>
